[
  {
    "objectID": "structural_analysis.html",
    "href": "structural_analysis.html",
    "title": "Täuber et al. (2026) in prep. - Structural analysis",
    "section": "",
    "text": "1 Install the coi package\n\n# install.packages(\"devtools\")\ndevtools::install_github(\"ataeub/coi\")\n\n\n\n2 Libraries & local scripts\n\nlibrary(magrittr)\n\nsource(here::here(\"src/make_manifest.R\"))\nsource(here::here(\"src/trees_to_tsps.R\"))\nsource(here::here(\"src/compute_tsp_structure.R\"))\nsource(here::here(\"src/compute_tsp_traits.R\"))\n\n\n\n3 Set global variables\nWe can change the algorithm parameters for the run by changing the values in the parameters list.\n\nsingle_tree_p &lt;- here::here(\"data/raw/single_trees\")\ntree_data_p &lt;- here::here(\"data/processed/tree_level_data.csv\")\noutput_p &lt;- here::here(\"data/results/tsp_data.csv\")\n\nparameters &lt;- list(\n  vox_res = 0.01,\n  coi_d_max = 0.3,\n  cci_strata_size = 0.3,\n  cci_strata_hull_type = \"concave\",\n  boxdim_threshold = 0.1\n)\n\n\n\n4 Prepare the data for processing\n\nmake_manifest() examines the directory with the single tree point clouds and compares it to our list of TSPs with pre-existing data on them (ID, species, etc.)\ncalculate_tsp_traits() extracts the trait related data. In our case only the TSP-LTD and the species composition of the TSP.\ntrees_to_tsps() is basically just widening our data from one-row-per-tree to one-row-per-TSP Here we and compare it\n\n\ntree_data &lt;- make_manifest(\n  tree_table_path = tree_data_p,\n  single_tree_path = single_tree_p\n)\n\ntraits &lt;- tree_data %&gt;%\n  calculate_tsp_traits()\n\ntsp_data &lt;- tree_data %&gt;%\n  trees_to_tsps() %&gt;%\n  dplyr::filter(!is.na(tree1_pc_path) & !is.na(tree2_pc_path)) %&gt;%\n  dplyr::left_join(traits, by = \"tsp\")\n\n\n\n5 Structural data processing\n\nThe magic happens in compute_tsp_structure() where the functions from the coi package are used to extract the structural variables from the point clouds\nSince the computation is quite resource intensive we use future and furrr to parallelize the computation to n-1 available physical CPU cores\n\n\n# Using the amount of physical cores minus one\ncores_to_use &lt;- parallelly::availableCores(logical = FALSE) - 1\nfuture::plan(multisession, workers = cores_to_use)\nprogressr::handlers(\"cli\")\noptions(progressr.show_after = 0)\n\nprogressr::with_progress({\n  p &lt;- progressr::progressor(steps = nrow(tsp_data))\n\n  full_data &lt;- tsp_data %&gt;%\n    dplyr::ungroup() %&gt;%\n    dplyr::mutate(\n      results = furrr::future_pmap(\n        list(tree1_pc_path, tree2_pc_path),\n        ~ compute_tsp_structure(..1, ..2, parameters, p),\n        .options = furrr::furrr_options(seed = TRUE)\n      )\n    ) %&gt;%\n    tidyr::unnest_wider(results)\n})\n\nreadr::write_csv(full_data, output_p)"
  },
  {
    "objectID": "models.html",
    "href": "models.html",
    "title": "Täuber et al. (2026) in prep. - Statistical analysis",
    "section": "",
    "text": "# Data manipulation\nlibrary(dplyr)\nlibrary(fs)\nlibrary(readr)\nlibrary(forcats)\nlibrary(here)\nlibrary(flextable)\n\n# Stats\nlibrary(mgcv)\nlibrary(glmmTMB)\nlibrary(lmerTest)\nlibrary(MuMIn)\nlibrary(performance)\nlibrary(gratia)\n\n# Plotting\nlibrary(sjPlot)\nlibrary(ggplot2)\nlibrary(patchwork)\n\n# Scale helper function\nsource(\"src/scale_descale.R\")\n\n\noptions(readr.show_col_types = FALSE)\n\ndata_path &lt;- here(\"data/results/tsp_data.csv\")\nfigure_path &lt;- here(\"data/results/figures\")"
  },
  {
    "objectID": "models.html#figure-2",
    "href": "models.html#figure-2",
    "title": "Täuber et al. (2026) in prep. - Statistical analysis",
    "section": "3.1 Figure 2",
    "text": "3.1 Figure 2\n\n3.1.1 Model\n\nglmm_coi_cci &lt;- glmmTMB::glmmTMB(coi ~ cci +\n                                 (1|tsp_comp),\n                         family = glmmTMB::beta_family(),\n                         data = full_data,\n                         REML = TRUE)\n\n\n\n3.1.2 Figure\n\nfigure_2\n\n\n\n\n\n\n\ntable_1\n\n\n\n \ncoi\n\n\nPredictors\nEstimates\nstd. Error\nCI\nStatistic\np\n\n\n(Intercept)\n-0.85\n0.20\n-1.24 – -0.46\n-4.24\n&lt;0.001\n\n\ncci\n-2.82\n0.32\n-3.45 – -2.19\n-8.81\n&lt;0.001\n\n\nRandom Effects\n\n\n\nσ2\n0.56\n\n\n\nτ00 tsp_comp\n0.13\n\n\nICC\n0.19\n\n\nN tsp_comp\n36\n\nObservations\n115\n\n\nMarginal R2 / Conditional R2\n0.422 / 0.530"
  },
  {
    "objectID": "models.html#figure-3",
    "href": "models.html#figure-3",
    "title": "Täuber et al. (2026) in prep. - Statistical analysis",
    "section": "3.2 Figure 3",
    "text": "3.2 Figure 3\n\n3.2.1 Models\n\n3.2.1.1 Crown complementarity index (CCI)\n\nglmm_cci &lt;- glmmTMB::glmmTMB(cci ~ tsp_ltd_s +\n                                   tsp_scd_s +\n                                   ln_sr_s +\n                                   ln_n_s +\n                                   (1|tsp_comp),\n                         family = glmmTMB::beta_family(link = \"logit\"),\n                         data = full_data,\n                         REML = TRUE)\n\nsummary(glmm_cci)\n\n Family: beta  ( logit )\nFormula:          \ncci ~ tsp_ltd_s + tsp_scd_s + ln_sr_s + ln_n_s + (1 | tsp_comp)\nData: full_data\n\n      AIC       BIC    logLik -2*log(L)  df.resid \n    -44.6     -25.4      29.3     -58.6       108 \n\nRandom effects:\n\nConditional model:\n Groups   Name        Variance Std.Dev.\n tsp_comp (Intercept) 0.09458  0.3075  \nNumber of obs: 115, groups:  tsp_comp, 36\n\nDispersion parameter for beta family ():  4.6 \n\nConditional model:\n            Estimate Std. Error z value Pr(&gt;|z|)    \n(Intercept)  0.53204    0.10267   5.182 2.20e-07 ***\ntsp_ltd_s    0.35929    0.10512   3.418 0.000631 ***\ntsp_scd_s    0.42854    0.10236   4.187 2.83e-05 ***\nln_sr_s      0.04521    0.09569   0.472 0.636617    \nln_n_s       0.05041    0.09161   0.550 0.582159    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nglmm_cci_1 &lt;- update(glmm_cci, ~ . - ln_sr_s)\nMuMIn::AICc(glmm_cci, glmm_cci_1)\n\n           df      AICc\nglmm_cci    7 -43.57623\nglmm_cci_1  6 -48.48764\n\nsummary(glmm_cci_1)\n\n Family: beta  ( logit )\nFormula:          cci ~ tsp_ltd_s + tsp_scd_s + ln_n_s + (1 | tsp_comp)\nData: full_data\n\n      AIC       BIC    logLik -2*log(L)  df.resid \n    -49.3     -32.8      30.6     -61.3       109 \n\nRandom effects:\n\nConditional model:\n Groups   Name        Variance Std.Dev.\n tsp_comp (Intercept) 0.0995   0.3154  \nNumber of obs: 115, groups:  tsp_comp, 36\n\nDispersion parameter for beta family (): 4.63 \n\nConditional model:\n            Estimate Std. Error z value Pr(&gt;|z|)    \n(Intercept)  0.53380    0.10351   5.157 2.51e-07 ***\ntsp_ltd_s    0.37480    0.10070   3.722 0.000198 ***\ntsp_scd_s    0.42413    0.10142   4.182 2.89e-05 ***\nln_n_s       0.04969    0.09204   0.540 0.589317    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nglmm_cci_2 &lt;- update(glmm_cci_1, ~ . - ln_n_s)\nMuMIn::AICc(glmm_cci_1, glmm_cci_2)\n\n           df      AICc\nglmm_cci_1  6 -48.48764\nglmm_cci_2  5 -53.41000\n\nsummary(glmm_cci_2)\n\n Family: beta  ( logit )\nFormula:          cci ~ tsp_ltd_s + tsp_scd_s + (1 | tsp_comp)\nData: full_data\n\n      AIC       BIC    logLik -2*log(L)  df.resid \n    -54.0     -40.2      32.0     -64.0       110 \n\nRandom effects:\n\nConditional model:\n Groups   Name        Variance Std.Dev.\n tsp_comp (Intercept) 0.1088   0.3298  \nNumber of obs: 115, groups:  tsp_comp, 36\n\nDispersion parameter for beta family (): 4.68 \n\nConditional model:\n            Estimate Std. Error z value Pr(&gt;|z|)    \n(Intercept)   0.5359     0.1047   5.118 3.09e-07 ***\ntsp_ltd_s     0.3753     0.1012   3.710 0.000207 ***\ntsp_scd_s     0.4220     0.1017   4.152 3.30e-05 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nglmm_cci_3 &lt;- update(glmm_cci_2, ~ . - I(tsp_ltd_s^2))\nMuMIn::AICc(glmm_cci_2, glmm_cci_3)\n\n           df   AICc\nglmm_cci_2  5 -53.41\nglmm_cci_3  5 -53.41\n\nsummary(glmm_cci_3)\n\n Family: beta  ( logit )\nFormula:          cci ~ tsp_ltd_s + tsp_scd_s + (1 | tsp_comp)\nData: full_data\n\n      AIC       BIC    logLik -2*log(L)  df.resid \n    -54.0     -40.2      32.0     -64.0       110 \n\nRandom effects:\n\nConditional model:\n Groups   Name        Variance Std.Dev.\n tsp_comp (Intercept) 0.1088   0.3298  \nNumber of obs: 115, groups:  tsp_comp, 36\n\nDispersion parameter for beta family (): 4.68 \n\nConditional model:\n            Estimate Std. Error z value Pr(&gt;|z|)    \n(Intercept)   0.5359     0.1047   5.118 3.09e-07 ***\ntsp_ltd_s     0.3753     0.1012   3.710 0.000207 ***\ntsp_scd_s     0.4220     0.1017   4.152 3.30e-05 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nsummary(glmm_cci_3)\n\n Family: beta  ( logit )\nFormula:          cci ~ tsp_ltd_s + tsp_scd_s + (1 | tsp_comp)\nData: full_data\n\n      AIC       BIC    logLik -2*log(L)  df.resid \n    -54.0     -40.2      32.0     -64.0       110 \n\nRandom effects:\n\nConditional model:\n Groups   Name        Variance Std.Dev.\n tsp_comp (Intercept) 0.1088   0.3298  \nNumber of obs: 115, groups:  tsp_comp, 36\n\nDispersion parameter for beta family (): 4.68 \n\nConditional model:\n            Estimate Std. Error z value Pr(&gt;|z|)    \n(Intercept)   0.5359     0.1047   5.118 3.09e-07 ***\ntsp_ltd_s     0.3753     0.1012   3.710 0.000207 ***\ntsp_scd_s     0.4220     0.1017   4.152 3.30e-05 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nconfint(glmm_cci_3, parm=\"beta_\", method=\"Wald\")\n\n                2.5 %    97.5 %  Estimate\n(Intercept) 0.3306691 0.7411569 0.5359130\ntsp_ltd_s   0.1770291 0.5735492 0.3752891\ntsp_scd_s   0.2227820 0.6212562 0.4220191\n\nperformance::r2(glmm_cci_3)\n\n# R2 for Mixed Models\n\n  Conditional R2: 0.841\n     Marginal R2: 0.658\n\n\n\n\n3.2.1.2 Crown overlap index (COI)\n\nglmm_coi &lt;- glmmTMB::glmmTMB(coi ~ tsp_ltd_s +\n                                   I(tsp_ltd_s^2) +\n                                   tsp_scd_s +\n                                   ln_sr_s +\n                                   ln_n_s +\n                                   (1|tsp_comp),\n                         family = glmmTMB::beta_family(),\n                         data = full_data,\n                         REML = TRUE)\nsummary(glmm_coi)\n\n Family: beta  ( logit )\nFormula:          \ncoi ~ tsp_ltd_s + I(tsp_ltd_s^2) + tsp_scd_s + ln_sr_s + ln_n_s +  \n    (1 | tsp_comp)\nData: full_data\n\n      AIC       BIC    logLik -2*log(L)  df.resid \n   -351.6    -329.7     183.8    -367.6       107 \n\nRandom effects:\n\nConditional model:\n Groups   Name        Variance Std.Dev.\n tsp_comp (Intercept) 0.124    0.3522  \nNumber of obs: 115, groups:  tsp_comp, 36\n\nDispersion parameter for beta family (): 9.67 \n\nConditional model:\n               Estimate Std. Error z value Pr(&gt;|z|)    \n(Intercept)    -2.47257    0.14091 -17.547   &lt;2e-16 ***\ntsp_ltd_s      -0.33800    0.16397  -2.061   0.0393 *  \nI(tsp_ltd_s^2)  0.04210    0.06561   0.642   0.5211    \ntsp_scd_s      -0.25057    0.10427  -2.403   0.0163 *  \nln_sr_s        -0.10982    0.10663  -1.030   0.3030    \nln_n_s         -0.10487    0.08937  -1.173   0.2406    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nglmm_coi_1 &lt;- update(glmm_coi, ~ . - I(tsp_ltd_s^2))\nMuMIn::AICc(glmm_coi, glmm_coi_1)\n\n           df      AICc\nglmm_coi    8 -350.2641\nglmm_coi_1  7 -355.8703\n\nsummary(glmm_coi_1)\n\n Family: beta  ( logit )\nFormula:          \ncoi ~ tsp_ltd_s + tsp_scd_s + ln_sr_s + ln_n_s + (1 | tsp_comp)\nData: full_data\n\n      AIC       BIC    logLik -2*log(L)  df.resid \n   -356.9    -337.7     185.5    -370.9       108 \n\nRandom effects:\n\nConditional model:\n Groups   Name        Variance Std.Dev.\n tsp_comp (Intercept) 0.1302   0.3608  \nNumber of obs: 115, groups:  tsp_comp, 36\n\nDispersion parameter for beta family (): 9.71 \n\nConditional model:\n            Estimate Std. Error z value Pr(&gt;|z|)    \n(Intercept) -2.43323    0.12671 -19.203   &lt;2e-16 ***\ntsp_ltd_s   -0.26462    0.11526  -2.296   0.0217 *  \ntsp_scd_s   -0.25183    0.10448  -2.410   0.0159 *  \nln_sr_s     -0.12000    0.10553  -1.137   0.2555    \nln_n_s      -0.10704    0.08957  -1.195   0.2321    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nglmm_coi_2 &lt;- update(glmm_coi_1, ~ . - ln_sr_s)\nMuMIn::AICc(glmm_coi_1, glmm_coi_2)\n\n           df      AICc\nglmm_coi_1  7 -355.8703\nglmm_coi_2  6 -359.5055\n\nsummary(glmm_coi_2)\n\n Family: beta  ( logit )\nFormula:          coi ~ tsp_ltd_s + tsp_scd_s + ln_n_s + (1 | tsp_comp)\nData: full_data\n\n      AIC       BIC    logLik -2*log(L)  df.resid \n   -360.3    -343.8     186.1    -372.3       109 \n\nRandom effects:\n\nConditional model:\n Groups   Name        Variance Std.Dev.\n tsp_comp (Intercept) 0.1473   0.3839  \nNumber of obs: 115, groups:  tsp_comp, 36\n\nDispersion parameter for beta family (): 9.73 \n\nConditional model:\n            Estimate Std. Error z value Pr(&gt;|z|)    \n(Intercept) -2.43668    0.12922 -18.856   &lt;2e-16 ***\ntsp_ltd_s   -0.31416    0.10975  -2.863   0.0042 ** \ntsp_scd_s   -0.23904    0.10345  -2.311   0.0208 *  \nln_n_s      -0.10515    0.09126  -1.152   0.2493    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nglmm_coi_3 &lt;- update(glmm_coi_2, ~ . - ln_n_s)\nMuMIn::AICc(glmm_coi_2, glmm_coi_3)\n\n           df      AICc\nglmm_coi_2  6 -359.5055\nglmm_coi_3  5 -363.4000\n\nsummary(glmm_coi_3)\n\n Family: beta  ( logit )\nFormula:          coi ~ tsp_ltd_s + tsp_scd_s + (1 | tsp_comp)\nData: full_data\n\n      AIC       BIC    logLik -2*log(L)  df.resid \n   -364.0    -350.2     187.0    -374.0       110 \n\nRandom effects:\n\nConditional model:\n Groups   Name        Variance Std.Dev.\n tsp_comp (Intercept) 0.1491   0.3861  \nNumber of obs: 115, groups:  tsp_comp, 36\n\nDispersion parameter for beta family (): 9.67 \n\nConditional model:\n            Estimate Std. Error z value Pr(&gt;|z|)    \n(Intercept)  -2.4344     0.1298 -18.754  &lt; 2e-16 ***\ntsp_ltd_s    -0.3156     0.1101  -2.867  0.00414 ** \ntsp_scd_s    -0.2359     0.1054  -2.238  0.02522 *  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nsummary(glmm_coi_3)\n\n Family: beta  ( logit )\nFormula:          coi ~ tsp_ltd_s + tsp_scd_s + (1 | tsp_comp)\nData: full_data\n\n      AIC       BIC    logLik -2*log(L)  df.resid \n   -364.0    -350.2     187.0    -374.0       110 \n\nRandom effects:\n\nConditional model:\n Groups   Name        Variance Std.Dev.\n tsp_comp (Intercept) 0.1491   0.3861  \nNumber of obs: 115, groups:  tsp_comp, 36\n\nDispersion parameter for beta family (): 9.67 \n\nConditional model:\n            Estimate Std. Error z value Pr(&gt;|z|)    \n(Intercept)  -2.4344     0.1298 -18.754  &lt; 2e-16 ***\ntsp_ltd_s    -0.3156     0.1101  -2.867  0.00414 ** \ntsp_scd_s    -0.2359     0.1054  -2.238  0.02522 *  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nconfint(glmm_coi_3, parm=\"beta_\", method=\"Wald\")\n\n                 2.5 %      97.5 %   Estimate\n(Intercept) -2.6887732 -2.17994621 -2.4343597\ntsp_ltd_s   -0.5313915 -0.09988431 -0.3156379\ntsp_scd_s   -0.4425743 -0.02931960 -0.2359469\n\nperformance::r2(glmm_coi_3)\n\n# R2 for Mixed Models\n\n  Conditional R2: 0.313\n     Marginal R2: 0.175\n\n\n\n\n\n3.2.2 Figure\n\nfigure_3\n\n\n\n\n\n\n\ntable_1_1\n\n\n\n \ncci\n\n\nPredictors\nEstimates\nstd. Error\nCI\nStatistic\np\n\n\n(Intercept)\n0.54\n0.10\n0.33 – 0.74\n5.12\n&lt;0.001\n\n\ntsp ltd s\n0.38\n0.10\n0.18 – 0.57\n3.71\n&lt;0.001\n\n\ntsp scd s\n0.42\n0.10\n0.22 – 0.62\n4.15\n&lt;0.001\n\n\nRandom Effects\n\n\n\nσ2\n0.09\n\n\n\nτ00 tsp_comp\n0.11\n\n\nICC\n0.54\n\n\nN tsp_comp\n36\n\nObservations\n115\n\n\nMarginal R2 / Conditional R2\n0.658 / 0.841\n\n\n\n\ntable_1_2\n\n\n\n \ncoi\n\n\nPredictors\nEstimates\nstd. Error\nCI\nStatistic\np\n\n\n(Intercept)\n-2.43\n0.13\n-2.69 – -2.18\n-18.75\n&lt;0.001\n\n\ntsp ltd s\n-0.32\n0.11\n-0.53 – -0.10\n-2.87\n0.004\n\n\ntsp scd s\n-0.24\n0.11\n-0.44 – -0.03\n-2.24\n0.025\n\n\nRandom Effects\n\n\n\nσ2\n0.74\n\n\n\nτ00 tsp_comp\n0.15\n\n\nICC\n0.17\n\n\nN tsp_comp\n36\n\nObservations\n115\n\n\nMarginal R2 / Conditional R2\n0.175 / 0.313"
  },
  {
    "objectID": "models.html#figure-s1---3",
    "href": "models.html#figure-s1---3",
    "title": "Täuber et al. (2026) in prep. - Statistical analysis",
    "section": "4.1 Figure S1 - 3",
    "text": "4.1 Figure S1 - 3\n\nfigure_s1\n\n\n\n\n\n\n\nfigure_s2\n\n\n\n\n\n\n\nfigure_s3"
  },
  {
    "objectID": "models.html#figure-s4",
    "href": "models.html#figure-s4",
    "title": "Täuber et al. (2026) in prep. - Statistical analysis",
    "section": "4.2 Figure S4",
    "text": "4.2 Figure S4\n\n4.2.1 Model\n\nglmm_ltd_scd &lt;- glmmTMB::glmmTMB(tsp_scd ~ tsp_ltd + (1|tsp_comp),\n                         family = gaussian(),\n                         data = full_data,\n                         REML = TRUE)\nsummary(glmm_ltd_scd)\n\n Family: gaussian  ( identity )\nFormula:          tsp_scd ~ tsp_ltd + (1 | tsp_comp)\nData: full_data\n\n      AIC       BIC    logLik -2*log(L)  df.resid \n      7.3      18.3       0.3      -0.7       111 \n\nRandom effects:\n\nConditional model:\n Groups   Name        Variance Std.Dev.\n tsp_comp (Intercept) 0.001722 0.0415  \n Residual             0.048673 0.2206  \nNumber of obs: 115, groups:  tsp_comp, 36\n\nDispersion estimate for gaussian family (sigma^2): 0.0487 \n\nConditional model:\n             Estimate Std. Error z value Pr(&gt;|z|)    \n(Intercept) 0.1596832  0.0355299   4.494 6.98e-06 ***\ntsp_ltd     0.0014968  0.0006271   2.387    0.017 *  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nperformance::r2(glmm_ltd_scd)\n\n# R2 for Mixed Models\n\n  Conditional R2: 0.088\n     Marginal R2: 0.056\n\nconfint(glmm_cci_3, parm=\"beta_\", method=\"Wald\")\n\n                2.5 %    97.5 %  Estimate\n(Intercept) 0.3306691 0.7411569 0.5359130\ntsp_ltd_s   0.1770291 0.5735492 0.3752891\ntsp_scd_s   0.2227820 0.6212562 0.4220191\n\n\n\n\n4.2.2 Figure\n\nfigure_s4"
  },
  {
    "objectID": "models.html#figure-s5",
    "href": "models.html#figure-s5",
    "title": "Täuber et al. (2026) in prep. - Statistical analysis",
    "section": "4.3 Figure S5",
    "text": "4.3 Figure S5\n\nfigure_s5"
  },
  {
    "objectID": "models.html#figure-s6",
    "href": "models.html#figure-s6",
    "title": "Täuber et al. (2026) in prep. - Statistical analysis",
    "section": "4.4 Figure S6",
    "text": "4.4 Figure S6\n\ndata_mono &lt;- filter(full_data, tsp_div == \"mono\")\ndata_mix &lt;- filter(full_data, tsp_div == \"mix\")\n\nltd_div_plot &lt;- ggplot(full_data, aes(tsp_div, tsp_ltd)) +\n    geom_violin(aes(fill = tsp_div), show.legend = FALSE) +\n    theme_classic() +\n    scale_y_continuous(\n      breaks = seq(0, 200, 40)\n    ) +\n    coord_cartesian(ylim = c(0, 200)) +\n    scale_x_discrete(labels=c(nrow(data_mono),\n                             nrow(data_mix))) +\n    xlab(\"n\") +\n    ylab(\"TSP-LTD\") +\n    theme(\n        plot.title = element_text(size = 20, hjust = 0.5),\n        axis.text = element_text(size = 20),\n        axis.title = element_text(size = 20)\n    )\nscd_div_plot &lt;- ggplot(full_data, aes(tsp_div, tsp_scd)) +\n    geom_violin(aes(fill = tsp_div)) +\n    theme_classic() +\n    xlab(\"Leaf habit\") +\n    ylab(\"TSP-SCD\") +\n    xlab(\"n\") +\n    labs(fill = \"TSP diversity\") +\n    scale_y_continuous(\n      breaks = seq(0, 1.4, 0.2)\n    ) +\n    scale_x_discrete(labels=c(nrow(data_mono),\n                             nrow(data_mix))) +\n    coord_cartesian(ylim = c(0, 1.4)) +\n    theme(\n        legend.text = element_text(size = 20),\n        legend.title = element_text(size = 20),\n        axis.text = element_text(size = 20),\n        axis.title = element_text(size = 20)\n    )\n\nfigure_s6 &lt;- wrap_plots(ltd_div_plot, scd_div_plot)\nggsave(file = path(figure_path, \"figure_s6.svg\"),\n    plot = figure_s6,\n    width=14,\n    height=7)\n\n\nfigure_s6"
  },
  {
    "objectID": "models.html#figure-s7",
    "href": "models.html#figure-s7",
    "title": "Täuber et al. (2026) in prep. - Statistical analysis",
    "section": "4.5 Figure S7",
    "text": "4.5 Figure S7\n\n4.5.1 Models\n\nsep_data &lt;- full_data %&gt;%\n    filter(tsp_div == \"mono\") %&gt;%\n    mutate(tsp_ltd_s = as.numeric(scale(tsp_ltd)))\n\nglmm_cci_sep &lt;- glmmTMB::glmmTMB(cci ~ tsp_ltd_s:tsp_habits +\n                                        tsp_scd_s:tsp_habits +\n                                  (1|tsp_comp),\n                         family = glmmTMB::beta_family(),\n                         data = sep_data,\n                         REML = TRUE)\nsummary(glmm_cci_sep)\n\n Family: beta  ( logit )\nFormula:          \ncci ~ tsp_ltd_s:tsp_habits + tsp_scd_s:tsp_habits + (1 | tsp_comp)\nData: sep_data\n\n      AIC       BIC    logLik -2*log(L)  df.resid \n    -15.0       1.9      14.5     -29.0        76 \n\nRandom effects:\n\nConditional model:\n Groups   Name        Variance Std.Dev.\n tsp_comp (Intercept) 0.06809  0.2609  \nNumber of obs: 83, groups:  tsp_comp, 15\n\nDispersion parameter for beta family (): 4.65 \n\nConditional model:\n                              Estimate Std. Error z value Pr(&gt;|z|)   \n(Intercept)                     0.3543     0.1246   2.843  0.00446 **\ntsp_ltd_s:tsp_habitsdeciduous   0.2289     0.1325   1.728  0.08404 . \ntsp_ltd_s:tsp_habitsevergreen   0.3672     0.1972   1.862  0.06261 . \ntsp_habitsdeciduous:tsp_scd_s   0.3234     0.1437   2.250  0.02448 * \ntsp_habitsevergreen:tsp_scd_s   0.4713     0.2125   2.218  0.02657 * \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nconfint(glmm_cci_sep, parm=\"beta_\", method=\"Wald\")\n\n                                    2.5 %    97.5 %  Estimate\n(Intercept)                    0.11008345 0.5985538 0.3543186\ntsp_ltd_s:tsp_habitsdeciduous -0.03077617 0.4886326 0.2289282\ntsp_ltd_s:tsp_habitsevergreen -0.01932768 0.7536414 0.3671569\ntsp_habitsdeciduous:tsp_scd_s  0.04162624 0.6050786 0.3233524\ntsp_habitsevergreen:tsp_scd_s  0.05478490 0.8877968 0.4712908\n\nperformance::r2(glmm_cci_sep)\n\n# R2 for Mixed Models\n\n  Conditional R2: 0.691\n     Marginal R2: 0.522\n\nglmm_coi_sep &lt;- glmmTMB::glmmTMB(coi ~ tsp_ltd_s:tsp_habits +\n                                      tsp_scd_s:tsp_habits +\n                                  (1|tsp_comp),\n                         family = glmmTMB::beta_family(),\n                         data = sep_data,\n                         REML = TRUE)\nsummary(glmm_coi_sep)\n\n Family: beta  ( logit )\nFormula:          \ncoi ~ tsp_ltd_s:tsp_habits + tsp_scd_s:tsp_habits + (1 | tsp_comp)\nData: sep_data\n\n      AIC       BIC    logLik -2*log(L)  df.resid \n   -210.8    -193.9     112.4    -224.8        76 \n\nRandom effects:\n\nConditional model:\n Groups   Name        Variance Std.Dev.\n tsp_comp (Intercept) 0.1681   0.41    \nNumber of obs: 83, groups:  tsp_comp, 15\n\nDispersion parameter for beta family (): 9.56 \n\nConditional model:\n                              Estimate Std. Error z value Pr(&gt;|z|)    \n(Intercept)                   -2.32991    0.16782 -13.883   &lt;2e-16 ***\ntsp_ltd_s:tsp_habitsdeciduous  0.10270    0.13252   0.775   0.4383    \ntsp_ltd_s:tsp_habitsevergreen -0.28784    0.21415  -1.344   0.1789    \ntsp_habitsdeciduous:tsp_scd_s -0.08706    0.14520  -0.600   0.5488    \ntsp_habitsevergreen:tsp_scd_s -0.48341    0.22053  -2.192   0.0284 *  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nconfint(glmm_coi_sep, parm=\"beta_\", method=\"Wald\")\n\n                                   2.5 %      97.5 %    Estimate\n(Intercept)                   -2.6588353 -2.00098476 -2.32991002\ntsp_ltd_s:tsp_habitsdeciduous -0.1570308  0.36243724  0.10270324\ntsp_ltd_s:tsp_habitsevergreen -0.7075633  0.13188360 -0.28783983\ntsp_habitsdeciduous:tsp_scd_s -0.3716512  0.19753393 -0.08705866\ntsp_habitsevergreen:tsp_scd_s -0.9156479 -0.05116994 -0.48340892\n\nperformance::r2(glmm_coi_sep)\n\n# R2 for Mixed Models\n\n  Conditional R2: 0.307\n     Marginal R2: 0.120\n\n\n\n\n4.5.2 Figure\n\nfigure_s7"
  }
]